var drupal=drupal||{};
(function(b){drupal.api=function(){this.url="http://rest";this.endpoint="rest";this.resource=""};drupal.api.prototype.getURL=function(a){var c=this.url;c+=this.endpoint?"/"+this.endpoint:"";c+=this.resource?"/"+this.resource:"";c+=a&&a.id?"/"+a.id:"";return c};drupal.api.prototype.call=function(a,c,d,e,f){a={url:a,dataType:c,type:d,success:function(a,c){c=="success"?f(a):console.log("Error: "+c)},error:function(a){console.log(a.responseText);f(null)}};e&&(a.data=e);b.ajax(a)};drupal.api.prototype.get=
function(a,c,b){a=this.getURL(a);a+=".jsonp";a+=c?"?"+decodeURIComponent(jQuery.param(c,true)):"";this.call(a,"jsonp","GET",null,b)};drupal.api.prototype.execute=function(a,c,b){this.call(this.getURL(c)+"/"+a,"json","POST",c,b)};drupal.api.prototype.save=function(a,c){var b=a.id?"PUT":"POST";this.call(this.getURL(a),"json",b,a,c)};drupal.api.prototype.remove=function(a,c){this.call(this.getURL(a),"json","DELETE",null,c)}})(jQuery);drupal=drupal||{};
(function(){drupal.system=function(b){this.user=null;this.api=new drupal.system.api;b&&this.connect(b)};drupal.system.prototype.connect=function(b){var a=this;this.api.execute("connect",null,function(c){a.user=new drupal.user(c.user);a.user.sessid=c.sessid;b(a)})};drupal.system.prototype.get_variable=function(b,a,c){this.api.execute("get_variable",{name:b,"default":a},c)};drupal.system.prototype.set_variable=function(b,a,c){this.api.execute("set_variable",{name:b,value:a},c)};drupal.system.prototype.del_variable=
function(b,a){this.api.execute("del_variable",{name:b},a)}})(jQuery);drupal=drupal||{};drupal.system=drupal.system||{};(function(){drupal.system.api=function(){drupal.api.call(this);this.resource="system"};drupal.system.api.prototype=new drupal.api;drupal.system.api.prototype.constructor=drupal.system.api})(jQuery);drupal=drupal||{};
(function(){drupal.entity=function(b,a){this.id="";this.api=this.api||null;this.update(b);a&&this.get(a)};drupal.entity.prototype.find=function(){};drupal.entity.prototype.get=function(b){if(this.api){var a=this;this.api.get(this.getObject(),this.getQuery(),function(c){c[0]?b(c):(a.update(c),b(a))})}};drupal.entity.prototype.save=function(b){if(this.api){var a=this;this.api.save(this.getObject(),function(c){a.update(c);b(a)})}};drupal.entity.prototype.remove=function(b){this.id&&this.api.remove(this.getObject(),
b)};drupal.entity.prototype.getQuery=function(){var b={};if(!this.id)for(var a in this)this.hasOwnProperty(a)&&this[a]&&typeof this[a]!="object"&&(b["parameters["+a+"]"]=this[a]);return b};drupal.entity.prototype.update=function(b){if(b)for(var a in b)b.hasOwnProperty(a)&&this.hasOwnProperty(a)&&(this[a].update?this[a].update(b[a]):this[a]=b[a])};drupal.entity.prototype.getObject=function(){return{id:this.id}}})(jQuery);drupal=drupal||{};
(function(b){drupal.node=function(a,c){this.type=this.title="";this.uid=this.status=0;this.api=new drupal.node.api;drupal.entity.call(this,a,c)};drupal.node.prototype=new drupal.entity;drupal.node.prototype.constructor=drupal.node;drupal.node.prototype.update=function(a){drupal.entity.prototype.update.call(this,a);this.id=a&&a.nid||this.id};drupal.node.prototype.getObject=function(){return b.extend(drupal.entity.prototype.getObject.call(this),{title:this.title,type:this.type,status:this.status,uid:this.uid})}})(jQuery);
drupal=drupal||{};drupal.node=drupal.node||{};(function(){drupal.node.api=function(){drupal.api.call(this);this.resource="node"};drupal.node.api.prototype=new drupal.api;drupal.node.api.prototype.constructor=drupal.node.api})(jQuery);drupal=drupal||{};
(function(b){drupal.user=function(a,c){this.pass=this.mail=this.name="";this.status=1;this.session_name=this.sessid="";this.api=new drupal.user.api;drupal.entity.call(this,a,c)};drupal.user.prototype=new drupal.entity;drupal.user.prototype.constructor=drupal.user;drupal.user.prototype.login=function(a){var c=this;this.api.execute("login",{username:this.name,password:this.pass},function(b){c.sessid=b.sessid;c.session_name=b.session_name;c.update(b.user);a(c)})};drupal.user.prototype.register=function(a){var b=
this;this.api.execute("register",this.getObject(),function(d){b.update(d);a(b)})};drupal.user.prototype.logout=function(a){this.api.execute("logout",null,a)};drupal.user.prototype.update=function(a){drupal.entity.prototype.update.call(this,a);this.id=a&&a.uid||this.id};drupal.user.prototype.getObject=function(){return b.extend(drupal.entity.prototype.getObject.call(this),{name:this.name,mail:this.mail,pass:this.pass,status:this.status})}})(jQuery);drupal=drupal||{};drupal.user=drupal.user||{};
(function(){drupal.user.api=function(){drupal.api.call(this);this.resource="user"};drupal.user.api.prototype=new drupal.api;drupal.user.api.prototype.constructor=drupal.user.api})(jQuery);
